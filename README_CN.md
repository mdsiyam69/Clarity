# Clarity

<p align="center">
  <strong>åŸºäºåŸç”Ÿ Claude-skill æ¶æ„çš„é‡‘èåˆ†ææ™ºèƒ½ä½“</strong>
</p>

<p align="center">
  <a href="./README.md"><strong>English</strong></a> | <strong>ç®€ä½“ä¸­æ–‡</strong>
</p>
<p align="center">
  <a href="./README.md">ğŸ‘‰ Switch to English</a>
</p>

<p align="center">
  <a href="https://www.cooragent.com/">
    <img src="https://img.shields.io/badge/Powered%20by-Cooragent-blue?style=flat-square" alt="Powered by Cooragent">
  </a>
  <a href="https://github.com/cooragent/Clarity/stargazers">
    <img src="https://img.shields.io/github/stars/cooragent/Clarity?style=flat-square" alt="GitHub Stars">
  </a>
  <a href="https://github.com/cooragent/Clarity/issues">
    <img src="https://img.shields.io/github/issues/cooragent/Clarity?style=flat-square" alt="GitHub Issues">
  </a>
</p>

<p align="center">
  <a href="#åŠŸèƒ½ç‰¹æ€§">åŠŸèƒ½ç‰¹æ€§</a> â€¢
  <a href="#å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</a> â€¢
  <a href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</a> â€¢
  <a href="#å·¥ä½œæµç¨‹">å·¥ä½œæµç¨‹</a> â€¢
  <a href="#æ¶æ„è®¾è®¡">æ¶æ„è®¾è®¡</a>
</p>

> ğŸŒŸ **å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼æ‚¨çš„æ”¯æŒæ˜¯æˆ‘ä»¬æŒç»­æ”¹è¿›çš„åŠ¨åŠ›ï¼**
> 
> ğŸ’¡ **æ¬¢è¿æå‡º Issue æˆ– PRï¼Œæˆ‘ä»¬éå¸¸é‡è§†æ‚¨çš„åé¦ˆå’Œå»ºè®®ï¼**

---

## ç®€ä»‹

Clarity æ˜¯ä¸€ä¸ªåŸºäº **åŸç”Ÿ Claude-skill** æ¶æ„çš„é‡‘èåˆ†ææ™ºèƒ½ä½“ï¼Œæ”¯æŒè‚¡ç¥¨åˆ†æã€æŒä»“è¿½è¸ªã€ç­›é€‰ç­–ç•¥å’Œå†³ç­–ä»ªè¡¨ç›˜ã€‚é‡‡ç”¨ **Planning-with-Files** æ¨¡å¼ï¼Œé€šè¿‡å¤šæ™ºèƒ½ä½“åä½œå®Œæˆå¤æ‚çš„é‡‘èåˆ†æä»»åŠ¡ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- ğŸ§  **Claude-skill åŸç”Ÿæ¶æ„** - éµå¾ª Anthropic æ¨èçš„æ™ºèƒ½ä½“è®¾è®¡æ¨¡å¼
- ğŸŒ **å¤šå¸‚åœºå…¨è¦†ç›–** - A è‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡æ•°æ®æºè‡ªåŠ¨åˆ‡æ¢
- ğŸ“Š **6 å¤§ä¸“ä¸šæ™ºèƒ½ä½“** - åŸºæœ¬é¢ã€æŠ€æœ¯é¢ã€æ–°é—»ã€æƒ…ç»ªã€æŒä»“ã€ç­›é€‰
- ğŸ”” **å¤šæ¸ é“æ¨é€** - ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ã€Telegramã€é‚®ä»¶ç­‰
- ğŸš€ **REST API & Web UI** - å®Œæ•´çš„æ¥å£å’Œå›¾å½¢ç•Œé¢

---

## æ•°æ®æº

Clarity æ•´åˆäº†å¤šä¸ªé‡‘èæ•°æ®æºï¼Œæ ¹æ®å¸‚åœºç±»å‹è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ•°æ®æºï¼š

| æ•°æ®ç±»å‹ | æ•°æ®æº | å¸‚åœºè¦†ç›– | è¯´æ˜ |
|:--------|:------|:---------|:-----|
| **A è‚¡è¡Œæƒ…** | AkShare | æ²ªæ·±ä¸»æ¿ã€ç§‘åˆ›æ¿ã€åˆ›ä¸šæ¿ | å®æ—¶æ•°æ® |
| **A è‚¡è¡Œæƒ…** | EFinance | æ²ªæ·±ä¸»æ¿ã€ç§‘åˆ›æ¿ã€åˆ›ä¸šæ¿ | å¤‡é€‰æ•°æ®æº |
| **å…¨çƒè¡Œæƒ…** | yFinance | ç¾è‚¡ã€æ¸¯è‚¡ã€A è‚¡ | å…¨çƒå¸‚åœº |
| **è´¢åŠ¡æ•°æ®** | SimFin | ç¾è‚¡ | è´¢æŠ¥æ•°æ® |
| **æ–°é—»èµ„è®¯** | Finnhub | å…¨çƒ | å…¬å¸æ–°é—» |
| **æ–°é—»èµ„è®¯** | Google News | å…¨çƒ | èšåˆæ–°é—» |
| **ç¤¾äº¤æƒ…ç»ª** | Reddit | å…¨çƒ | ç¤¾åŒºè®¨è®º |
| **æŠ€æœ¯æŒ‡æ ‡** | Stockstats | å…¨çƒ | æŠ€æœ¯åˆ†æ |
| **ç½‘é¡µæœç´¢** | Serper API | å…¨çƒ | å¢å¼ºæœç´¢èƒ½åŠ› |
| **å†…å®¹æå–** | Jina AI | å…¨çƒ | ç½‘é¡µè§£æ |

**æ•°æ®æºä¼˜å…ˆçº§ç­–ç•¥ï¼š**
- **A è‚¡**ï¼šAkShare (ä¼˜å…ˆ) â†’ EFinance (å¤‡é€‰) â†’ yFinance (å…œåº•)
- **æ¸¯è‚¡**ï¼šyFinance
- **ç¾è‚¡**ï¼šyFinance + Finnhub + SimFin

---

## åŠŸèƒ½ç‰¹æ€§

| åŠŸèƒ½ | æè¿° |
|:-----|:-----|
| **è‚¡ç¥¨åˆ†æ** | æŠ€æœ¯é¢ + åŸºæœ¬é¢ + æ–°é—» + å¸‚åœºæƒ…ç»ªå››ç»´åº¦æ·±åº¦åˆ†æ |
| **æŒä»“è·Ÿè¸ª** | è¿½è¸ª Warren Buffett ç­‰çŸ¥åæŠ•èµ„è€…çš„æœ€æ–°æŒä»“å˜åŒ– |
| **è‚¡ç¥¨ç­›é€‰** | åŸºäºè‡ªç„¶è¯­è¨€æè¿°ç­›é€‰ç¬¦åˆæ¡ä»¶çš„è‚¡ç¥¨ |
| **å†³ç­–ä»ªè¡¨ç›˜** | æ¯æ—¥è‡ªåŠ¨æ‰«æå¸‚åœºå¹¶æ¨èå€¼å¾—å…³æ³¨çš„è‚¡ç¥¨ |
| **å¤šæ¸ é“æ¨é€** | åˆ†ææŠ¥å‘Šè‡ªåŠ¨æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ã€Telegram ç­‰ |

---

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
git clone https://github.com/your-org/Clarity.git
cd Clarity

# ä½¿ç”¨ uvï¼ˆæ¨èï¼‰
uv sync
```

### é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# ===== å¿…éœ€é…ç½® =====
OPENAI_API_KEY=your_openai_api_key           # OpenAI APIï¼ˆæˆ–å…¼å®¹æ¥å£ï¼‰
FINNHUB_API_KEY=your_finnhub_api_key         # Finnhub æ–°é—»æ•°æ®ï¼ˆå…è´¹å±‚å¯ç”¨ï¼‰

# ===== å¯é€‰ï¼šå¢å¼ºæœç´¢ï¼ˆæ¨èé…ç½®ï¼‰=====
SERPER_API_KEY=your_serper_api_key           # Google æœç´¢ API
JINA_API_KEY=your_jina_api_key               # ç½‘é¡µå†…å®¹æå–

# ===== å¯é€‰ï¼šé€šçŸ¥æ¨é€ =====
WECHAT_WEBHOOK_URL=https://qyapi.weixin.qq.com/...     # ä¼ä¸šå¾®ä¿¡
FEISHU_WEBHOOK_URL=https://open.feishu.cn/...          # é£ä¹¦
TELEGRAM_BOT_TOKEN=123456:ABC-DEF...                   # Telegram
TELEGRAM_CHAT_ID=123456789
EMAIL_SENDER=your@qq.com                               # é‚®ä»¶
EMAIL_PASSWORD=æˆæƒç 

# ===== å¯é€‰ï¼šQwen æ¨¡å‹ï¼ˆé˜¿é‡Œé€šä¹‰åƒé—®ï¼‰=====
QWEN_API_KEY=your_dashscope_api_key
QWEN_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
QWEN_MODEL=qwen-latest
# ä½¿ç”¨æ–¹å¼ï¼šuv run run_agent.py --model qwen analyze AAPL
```

---

## ä½¿ç”¨æ–¹æ³•

### REST API

Clarity æä¾›äº†å®Œæ•´çš„ RESTful API æ¥å£ï¼Œæ”¯æŒæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ã€‚

```bash
# å¯åŠ¨ API æœåŠ¡å™¨
uv run python api.py

# è‡ªå®šä¹‰ç«¯å£å’Œåœ°å€
API_PORT=8000 API_HOST=0.0.0.0 uv run python api.py
```

API æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® http://localhost:8000/docs æŸ¥çœ‹äº¤äº’å¼ API æ–‡æ¡£ã€‚

#### API ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | æè¿° | ç¤ºä¾‹ |
|:-----|:-----|:-----|:-----|
| `/health` | GET | å¥åº·æ£€æŸ¥ | - |
| `/api/v1/analyze` | POST | è‚¡ç¥¨åˆ†æ | `{"ticker": "AAPL", "model": "openai"}` |
| `/api/v1/track` | POST | æŒä»“è·Ÿè¸ª | `{"investor_name": "Warren Buffett"}` |
| `/api/v1/screen` | POST | è‚¡ç¥¨ç­›é€‰ | `{"criteria": "high dividend yield"}` |
| `/api/v1/ask` | POST | è‡ªç„¶è¯­è¨€æŸ¥è¯¢ | `{"query": "åˆ†æè‹¹æœå…¬å¸"}` |
| `/api/v1/dashboard` | POST | å†³ç­–ä»ªè¡¨ç›˜ | `{"markets": ["Aè‚¡"], "top_n": 10}` |
| `/api/v1/notification/channels` | GET | è·å–é€šçŸ¥æ¸ é“ | - |

#### ä½¿ç”¨ç¤ºä¾‹

```bash
# åˆ†æè‚¡ç¥¨
curl -X POST "http://localhost:8000/api/v1/analyze" \
  -H "Content-Type: application/json" \
  -d '{"ticker": "AAPL", "model": "openai"}'

# è¿½è¸ªæŠ•èµ„è€…æŒä»“
curl -X POST "http://localhost:8000/api/v1/track" \
  -H "Content-Type: application/json" \
  -d '{"investor_name": "Warren Buffett"}'

# å†³ç­–ä»ªè¡¨ç›˜ï¼ˆæ¨é€é€šçŸ¥ï¼‰
curl -X POST "http://localhost:8000/api/v1/dashboard" \
  -H "Content-Type: application/json" \
  -d '{"markets": ["Aè‚¡", "ç¾è‚¡"], "top_n": 10, "push": true}'
```

#### Python å®¢æˆ·ç«¯ç¤ºä¾‹

```python
import httpx
import asyncio

async def analyze_stock(ticker: str):
    async with httpx.AsyncClient() as client:
        response = await client.post(
            "http://localhost:8000/api/v1/analyze",
            json={"ticker": ticker, "model": "openai"}
        )
        return response.json()

# è¿è¡Œ
result = asyncio.run(analyze_stock("AAPL"))
print(result["report"])
```

### Web UI

```bash
# å¯åŠ¨ç¯å¢ƒ
source .venv/bin/activate

# å¯åŠ¨ Web ç•Œé¢
uv run python webui.py

# åˆ›å»ºå…¬å¼€é“¾æ¥ï¼ˆé€šè¿‡ Gradio Shareï¼‰
uv run python webui.py --share
```

è®¿é—® http://localhost:7860 å³å¯ä½¿ç”¨å›¾å½¢ç•Œé¢ã€‚

<video src="assets/ui.mp4" controls width="800"></video>

### CLI å‘½ä»¤

```bash
# åˆ†æè‚¡ç¥¨
uv run python run_agent.py analyze AAPL
uv run python run_agent.py analyze NVDA --date 2025-01-15
uv run python run_agent.py --model qwen analyze AAPL

# è·Ÿè¸ªæŠ•èµ„è€…æŒä»“
uv run python run_agent.py track "Warren Buffett"

# ç­›é€‰è‚¡ç¥¨
uv run python run_agent.py screen "high dividend yield tech stocks"

# è‡ªç„¶è¯­è¨€æŸ¥è¯¢
uv run python run_agent.py ask "åˆ†æä¸€ä¸‹è‹¹æœå…¬å¸çš„è‚¡ç¥¨"

# å†³ç­–ä»ªè¡¨ç›˜
uv run python run_agent.py dashboard                           # æ‰«æ Aè‚¡+ç¾è‚¡
uv run python run_agent.py dashboard -m Aè‚¡ æ¸¯è‚¡              # æ‰«ææŒ‡å®šå¸‚åœº
uv run python run_agent.py dashboard -n 20 -o report.md       # æ¨è20åªï¼Œä¿å­˜åˆ°æ–‡ä»¶
uv run python run_agent.py dashboard --push                   # æ‰«æå¹¶æ¨é€é€šçŸ¥
uv run python run_agent.py dashboard -p --push-to wechat      # ä»…æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡
```

### Python ä»£ç 

```python
import asyncio
from clarity import FinancialAgentOrchestrator, AgentConfig, TaskType

async def main():
    orchestrator = FinancialAgentOrchestrator()

    # åˆ†æè‚¡ç¥¨
    result = await orchestrator.run(
        task_type=TaskType.STOCK_ANALYSIS,
        target="AAPL",
    )
    print(result["report"])

asyncio.run(main())
```

```python
# ä½¿ç”¨é€šçŸ¥æœåŠ¡
from clarity.core import NotificationService

notification = NotificationService()
notification.send("# æµ‹è¯•æŠ¥å‘Š\nè¿™æ˜¯ Markdown æ ¼å¼çš„æ¶ˆæ¯")
```

---

## å·¥ä½œåŸç†

### Planning-with-Files æ¨¡å¼

ç³»ç»Ÿä½¿ç”¨ä¸‰ä¸ªæŒä¹…åŒ–æ–‡ä»¶ç®¡ç†é•¿ä»»åŠ¡ï¼Œè§£å†³ LLM "é—å¿˜"é—®é¢˜ï¼š

| æ–‡ä»¶ | ä½œç”¨ |
|:-----|:-----|
| `task_plan.md` | ä»»åŠ¡è®¡åˆ’ã€é˜¶æ®µçŠ¶æ€ã€æ™ºèƒ½ä½“åˆ†é… |
| `findings.md` | ç ”ç©¶å‘ç°ã€API æ•°æ®ã€åˆ†æç»“æœ |
| `progress.md` | æ‰§è¡Œæ—¥å¿—ã€é”™è¯¯è®°å½•ã€é‡è¯•è¿½è¸ª |

**æ‰§è¡Œæµç¨‹ï¼š** MasterAgent è§„åˆ’ â†’ WorkingAgent æ‰§è¡Œ â†’ SubAgents åˆ†å·¥ â†’ StateChecker éªŒè¯ â†’ ç”ŸæˆæŠ¥å‘Š

---

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ™ºèƒ½ä½“

| æ™ºèƒ½ä½“ | èŒè´£ |
|:-------|:-----|
| **MasterAgent** | ä»»åŠ¡è§„åˆ’ã€ç»“æœåˆæˆ |
| **WorkingAgent** | æ‰§è¡Œåè°ƒã€æµç¨‹æ§åˆ¶ |
| **StateChecker** | çŠ¶æ€éªŒè¯ã€é”™è¯¯é‡è¯• |
| **Fundamentals Analyst** | è´¢åŠ¡æŠ¥è¡¨ã€åŸºæœ¬é¢åˆ†æ |
| **Technical Analyst** | æŠ€æœ¯æŒ‡æ ‡ï¼ˆMACDã€RSIã€å¸ƒæ—å¸¦ï¼‰|
| **News Analyst** | æ–°é—»æ”¶é›†ä¸æƒ…æ„Ÿåˆ†æ |
| **Sentiment Analyst** | ç¤¾äº¤åª’ä½“æƒ…ç»ªç›‘æ§ |
| **Holdings Hunter** | æœºæ„æŒä»“è¿½è¸ªï¼ˆSEC 13Fï¼‰|
| **Alpha Hound** | è‚¡ç¥¨ç­›é€‰ä¸è¯„åˆ† |

### ç›®å½•ç»“æ„

```
Clarity/
â”œâ”€â”€ api.py               # REST API æœåŠ¡å™¨
â”œâ”€â”€ webui.py             # Gradio Web ç•Œé¢
â”œâ”€â”€ run_agent.py         # CLI å‘½ä»¤è¡Œå·¥å…·
â””â”€â”€ clarity/
    â”œâ”€â”€ core/            # æ ¸å¿ƒæ™ºèƒ½ä½“ä¸å·¥å…·
    â””â”€â”€ dataflows/       # æ•°æ®æºé›†æˆ
```

---

## æ”¯æŒä¸è´¡çŒ®

æœ¬é¡¹ç›®ç”± Cooragent å›¢é˜Ÿæä¾›æŠ€æœ¯æ”¯æŒã€‚Cooragent æ˜¯è‡ªæ¼”è¿›çš„å¤šæ™ºèƒ½ä½“å¹³å°ï¼Œè‡´åŠ›äºè®©æ¯ä¸ªäººéƒ½èƒ½æˆä¸º Agent çš„æŒ‡æŒ¥å®˜ã€‚

### ğŸŒŸ æ”¯æŒæˆ‘ä»¬

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ï¼š

- â­ **ç»™é¡¹ç›®ç‚¹ä¸ª Star** - è¿™æ˜¯å¯¹æˆ‘ä»¬æœ€å¤§çš„é¼“åŠ±ï¼
- ğŸ› **æäº¤ Issue** - æŠ¥å‘Š Bug æˆ–æå‡ºåŠŸèƒ½å»ºè®®
- ğŸ”€ **æäº¤ PR** - æ¬¢è¿è´¡çŒ®ä»£ç å’Œæ–‡æ¡£æ”¹è¿›
- ğŸ’¬ **åŠ å…¥ç¤¾åŒº** - ä¸å…¶ä»–ç”¨æˆ·äº¤æµä½¿ç”¨ç»éªŒ

### ğŸ“® è”ç³»æˆ‘ä»¬

- ğŸŒ é£ä¹¦: [cooragent](https://applink.feishu.cn/client/chat/chatter/add_by_link?link_token=251mf86f-8106-4361-81aa-05fa856abc05)
- ğŸ“§ é—®é¢˜åé¦ˆï¼šè¯·é€šè¿‡ [GitHub Issues](https://github.com/cooragent/Clarity/issues) æäº¤

---

## Star History

<a href="https://star-history.com/#cooragent/Clarity&Date">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="https://api.star-history.com/svg?repos=cooragent/Clarity&type=Date&theme=dark" />
   <source media="(prefers-color-scheme: light)" srcset="https://api.star-history.com/svg?repos=cooragent/Clarity&type=Date" />
   <img alt="Star History Chart" src="https://api.star-history.com/svg?repos=cooragent/Clarity&type=Date" />
 </picture>
</a>
